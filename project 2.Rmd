---
title: "Project 1: Comparing the Statisitics of Countries in the World"
author: "Pixuan Shen"
output: html_document
date: "2024-10-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(janitor)
library(ggplot2)
library(maps)
```

This visualization shows the countries of the world colored by the percentage of their land that is arable. The gradient runs from a light blue color for countries with a low percentage of their land being arable, to purple for countries with with a high percentage of their land being arable. When taking a look at the graph, it is possible to see that most of the countries with a lot of arable land are from western Europe, North America, and South Asia. What is interesting is that countries that are near the equator, which is located at 0 degrees latitude, do not have the most arable land. 
```{r}
countrydataset<-read.csv("data/countries of the world.csv")

countrydataset <- countrydataset %>%
  mutate(Arable = as.numeric(gsub(",", ".", Arable)))

mapdata <- map_data("world")

countrydataset <- countrydataset %>%
  mutate(Country = case_when(Country == "United States" ~ "usa",
    TRUE ~ Country))

mapdata <- mapdata %>%
  mutate(region = tolower(region))

countrydataset <- countrydataset %>%
  mutate(Country = tolower(Country))

mapdata <- left_join(mapdata, countrydataset, by = c("region" = "Country"))

cleandata <- mapdata %>%
  filter(!is.na(Arable))

ggplot(cleandata, aes(x = long, y = lat)) +
  geom_polygon(aes(group = group, fill = Arable), color = "gray") +
  scale_fill_gradient(low = "lightblue", high = "purple", na.value = "gray") +
  theme_minimal() +
  labs(fill = "% Arable Land", 
       title = "Countries of the World by Arable Land (%)", 
       x = "Longitude", 
       y = "Latitude") +
  coord_fixed()
```

The second visualization shows a plot that shows the GDP per capita of each country vs the amount of arable land they have. This is a continuation of the first graph that aims to show if there are relationships between the amount of arable land and a country's economic power. The graph is fitted with a line of best fit, which is in orange. While there are no statistical tests being ran here, it is possible to see that the regression line on the graph has a low slope, which either means that there is no relationship between arable land and GDP per capita, or that there is a very weak relationship at best. 
```{r}
countrydataset <- countrydataset %>%
  mutate(Arable = as.numeric(Arable),
    GDP_per_capita = as.numeric(GDP_per_capita)) %>%
  filter(!is.na(Arable), !is.na(GDP_per_capita))

ggplot(countrydataset, aes(x = GDP_per_capita/10000, y = Arable)) +
  geom_point(color = "blue", size = 2, alpha = 1) + 
  geom_smooth(method = "lm", color = "orange", linetype = "solid", se = FALSE) +
  xlim(0,6) +
  ylim(0,75) + 
  labs(title = "Relationship Between Arable Land (%) and GDP per capita (USD)",
    x = "GDP Per Capita (in 10,000 US $)",
    y = "Arable Land (%)") +
  theme_minimal()
```

Visualization improvements:
The changes to my visualization mainly involved the colors and the labels on the graphs. For the first graph, the world map, I changed the color for the country borders, which was suggested because the black color for the border made it very hard to see some of the smaller countries. I changed it to a gray color, which makes it slightly easier to tell the countries apart from one another. For the second graph, I changed the color of the regression line because somebody said that the purple on blue made it hard to see, which I also agreed with. I changed the color from purple to orange, which I think makes it much easier to see. Also, the second graph, I changed the GDP per capita from just USD to smaller units. In this case, the x-axis is in single digits, where each digit is 10,000 USD. Additionally, while it was not in the feedback, I changed the y-axis to max out at 75 because no single country actually goes above that amount. Lastly, I changed the titles for both graphs in response to feedback because the titles before were too long. 



Dataset From Kaggle:

https://www.kaggle.com/datasets/fernandol/countries-of-the-world


References:

R Help Page - geom_smooth

https://stackoverflow.com/questions/61838700/query-on-how-to-make-world-heat-map-using-ggplot-in-r

https://stackoverflow.com/questions/34608767/add-geom-smooth-to-boxplot

https://stackoverflow.com/questions/12746667/increasing-the-line-thickness-of-geom-smooth

